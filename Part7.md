# Первый рефактор, наканец та!

Пошукав по сети я понял что без векторов в спортивном симуляторе никуда, а ни в луа ни в лаве встроенной библиотеки нет.  

###### Будем писать свою!

Что нам понадобится (уже понадобилось): нормализация, длина (ака расстояние до), умножение на скаляр, да и умножение на вектор до кучи.  
Пока не буду выебываться и писать ООП, хватит и  того что теперь каждый объект в игре перерабатывать.
```
function mag (v)
	return math.sqrt(v.x^2 + v.y^2)
end

function norm (v)
	local m = mag (v)
	if (m ~= 0) v.x=v.x/m v.y=v.y/m end 
end

function dist (s,f)
	local v = {}
	v.x = f.x - s.x
	v.y = f.y - s.y
	return mag (v)
end

function dir (s,f)
	local v = {}
	v.x = f.x - s.x
	v.y = f.y - s.y
	return norm (v)
end

function scale (v,s)
	v.x=v.x*s
	v.y=v.y*s
end

function vector.dot(s,f)
    return s.x * f.x + s.y * f.y
end
```
Таак, везде простая математика. s - f start - finish, не считая одного случая когда s - scale.  
Положим это в отдельный файлик vectars.lua (cпециально с ашипкой, чтобы никто не подумал что библиотека хорошо написана), и реквайрим его.
